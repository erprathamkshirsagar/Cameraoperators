{% extends 'base.html' %}

{% block content %}

<style>
/* =============================
   GLOBAL THEME
   ============================= */
:root {
    --red: #D10024;
    --black: #000000;
    --light-red: #ffe5e9;
}

/* Page spacing */
.orders-wrapper {
    width: 100%;
    max-width: 1250px;
    margin: 40px auto;
    padding: 0 20px;
}

/* =============================
   PAGE TITLE
   ============================= */
.orders-title {
    font-size: 32px;
    font-weight: 700;
    color: var(--red);
    margin-bottom: 20px;
}

/* =============================
   CUSTOM TABLE
   ============================= */
.table-box {
    width: 100%;
    overflow-x: auto;
    border-radius: 12px;
    box-shadow: 0 0 8px rgba(0,0,0,0.15);
    background: white;
}

.custom-table {
    width: 100%;
    border-collapse: collapse;
    min-width: 1100px;
}

.custom-table thead {
    background: var(--black);
    color: white;
}

.custom-table th,
.custom-table td {
    padding: 12px 14px;
    border-bottom: 1px solid #ccc;
    text-align: center;
    font-size: 14px;
}

.custom-table tbody tr:hover {
    background: var(--light-red);
}

/* =============================
   BADGES
   ============================= */
.badge {
    padding: 4px 10px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    display: inline-block;
}

.badge-red {
    background: var(--red);
    color: white;
}

.badge-black {
    background: var(--black);
    color: white;
}

/* =============================
   BUTTONS
   ============================= */
.btn {
    padding: 6px 14px;
    font-size: 13px;
    border-radius: 6px;
    cursor: pointer;
    border: none;
    font-weight: 600;
    transition: 0.2s;
    display: inline-block;
}

.btn-red {
    background: var(--red);
    color: white;
}
.btn-red:hover {
    background: #b3001e;
}

.btn-black {
    background: var(--black);
    color: white;
}
.btn-black:hover {
    background: #333;
}

/* =============================
   DESCRIPTION CELL ELLIPSIS
   ============================= */
.description-cell {
    max-width: 200px;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
}

/* No data */
.no-bookings {
    padding: 16px;
    background: var(--red);
    color: white;
    font-weight: bold;
    text-align: center;
    border-radius: 10px;
}
</style>
<div class="container my-5">
    <!-- FREELANCER BOOKINGS -->
    <h2 class="fw-bold">My Bookings</h2>
    <p class="text-muted">Bookings made by you, {{ client.first_name }} {{ client.surname }}</p>

    {% if bookings %}
        <table class="table table-striped table-bordered shadow-sm">
            <thead class="table-dark">
                <tr>
                    <th>Freelancer Name</th>
                    <th>Skill</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Time</th>
                    <th>Price</th>
                    <th>Status</th>
                </tr>
            </thead>

            <tbody>
            {% for booking in bookings %}
                <tr>
                    <td>{{ booking.freelancer.first_name }} {{ booking.freelancer.surname }}</td>
                    <td>{{ booking.skill.category }}</td>
                    <td>{{ booking.start_date|date:"d M Y" }}</td>
                    <td>{{ booking.end_date|date:"d M Y" }}</td>
                    <td>{{ booking.start_time|time:"H:i" }} - {{ booking.end_time|time:"H:i" }}</td>
                    <td>₹{{ booking.skill.rate }}</td>

                    <td>
                        {% if booking.status == 'completed' %}
                            <span class="badge bg-secondary">Completed</span>
                        {% elif booking.status == 'upcoming' %}
                            <span class="badge bg-success">Upcoming</span>
                        {% elif booking.status == 'cancelled' %}
                            <span class="badge bg-danger">Cancelled</span>
                        {% else %}
                            <span class="badge bg-info">{{ booking.status|capfirst }}</span>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="text-muted">You have no bookings yet.</p>
    {% endif %}
</div>


<!-- PRODUCT RENTAL BOOKINGS -->
<div class="container my-5">
    <h3 class="fw-bold mb-3">Product Rental Bookings</h3>

    {% if product_bookings %}
        <table class="table table-bordered table-striped align-middle shadow-sm">
            <thead class="table-dark">
                <tr>
                    <th style="width: 120px;">Image</th>
                    <th>Product Name</th>
                    <th>Booking Dates</th>
                    <th>Total Days</th>
                    <th>Booked On</th>
                </tr>
            </thead>

            <tbody>
            {% for p in product_bookings %}
                <tr>
                    <!-- IMAGE -->
                    <td>
                        {% if p.product.images.all %}
                            <img src="{{ p.product.images.all.0.image.url }}"
                                 class="img-fluid rounded shadow-sm"
                                 style="height: 80px; width: 80px; object-fit: cover;">
                        {% else %}
                            <img src="https://via.placeholder.com/80"
                                 class="img-fluid rounded shadow-sm">
                        {% endif %}
                    </td>

                    <!-- PRODUCT NAME -->
                    <td class="fw-bold">{{ p.product.title }}</td>

                    <!-- DATE RANGE -->
                    <td>
                        <span class="badge bg-info text-dark p-2">
                            {{ p.start_date|date:"d M Y" }} → {{ p.end_date|date:"d M Y" }}
                        </span>
                    </td>

                    <!-- TOTAL DAYS -->
                    <td>
                        <span class="badge bg-primary">{{ p.total_days }} Days</span>
                    </td>

                    <!-- CREATED DATE -->
                    <td>
                        {{ p.created_at|date:"d M Y" }}<br>
                        <small class="text-muted">Booking Created</small>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

    {% else %}
        <p class="text-muted">No product rental bookings found.</p>
    {% endif %}
</div>

{% endblock %}
